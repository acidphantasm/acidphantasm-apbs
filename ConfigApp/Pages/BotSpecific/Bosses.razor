@page "/boss"
@inherits LayoutComponentBase
@using static Core.DataLoader;

<MudMainContent>
    <MudContainer>
        <MudExpansionPanels MultiExpansion="true">
            <MudExpansionPanel Class="mud-expansion-panels-borders ma-3 pa-5" Text="Boss Specific Configuration" Expanded=true>
                <MudGrid>

                    <MudItem xs="1" />
                    <MudItem xs="4">
                        <MudPaper Class="d-flex align-center mud-width-full ma-1" Elevation="0">
                            <MudTooltip Text="Grants APBS control over Bosses. You will have vanilla Bosses if disabled." Color="Color.Secondary" Placement="Placement.Right" Arrow="true">
                                <MudText>Enable Boss Generation</MudText>
                            </MudTooltip>
                        </MudPaper>
                    </MudItem>
                    <MudItem xs="6">
                        <MudPaper Class="d-flex align-center mud-width-full" Elevation="0">
                            <MudSwitch T="bool" @bind-Value="Data.enableBossTierGeneration" Color="Color.Success" UncheckedColor="Color.Error" LabelPlacement="Placement.End">@Data.enableBossTierGeneration</MudSwitch>
                        </MudPaper>
                    </MudItem>
                    <MudItem xs="1">
                        <MudButton @onclick="resetBossTierGeneration" Variant="Variant.Filled" Color="Color.Dark" Size="Size.Small">Reset</MudButton>
                    </MudItem>

                </MudGrid>
            </MudExpansionPanel>
            @if (Data.enableBossTierGeneration)
            {
                <MudExpansionPanel Class="mud-expansion-panels-borders ma-3 pa-5" Text="Boss Specific Options" Expanded=true>
                    <MudGrid>

                        <MudItem xs="1" />
                        <MudItem xs="4">
                            <MudTooltip Text="Adjust Boss Weapon Durability." Color="Color.Secondary" Placement="Placement.Right" Arrow="true">
                                <MudText>Weapon Durability</MudText>
                            </MudTooltip>
                        </MudItem>
                        <MudItem xs="6">
                            <MudPaper Class="d-flex align-start mud-width-full" Elevation="0">
                                <MudTooltip Text="Lowest a weapon's 'non-repairable' durability can be." Color="Color.Secondary" Placement="Placement.Right" Arrow="true">
                                    <MudNumericField Margin="Margin.Dense" HideSpinButtons="true" @bind-Value="bossWeaponDurability[0]" Label="Min Durability" Variant="Variant.Filled" Min="0" Max="100" />
                                </MudTooltip>
                                <MudTooltip Text="Highest a weapon's 'non-repairable' durability can be." Color="Color.Secondary" Placement="Placement.Right" Arrow="true">
                                    <MudNumericField Margin="Margin.Dense" HideSpinButtons="true" @bind-Value="bossWeaponDurability[1]" Label="Max Durability" Variant="Variant.Filled" Min="0" Max="100" />
                                </MudTooltip>
                                <MudTooltip Text="Lowest possible difference from the rolled 'non-repairable' durabilty to the 'current' durability." Color="Color.Secondary" Placement="Placement.Left" Arrow="true">
                                    <MudNumericField Margin="Margin.Dense" HideSpinButtons="true" @bind-Value="bossWeaponDurability[2]" Label="Min Delta" Variant="Variant.Filled" Min="0" Max="100" />
                                </MudTooltip>
                                <MudTooltip Text="Highest possible difference from the rolled 'non-repairable' durabilty to the 'current' durability." Color="Color.Secondary" Placement="Placement.Left" Arrow="true">
                                    <MudNumericField Margin="Margin.Dense" HideSpinButtons="true" @bind-Value="bossWeaponDurability[3]" Label="Min Delta" Variant="Variant.Filled" Min="0" Max="100" />
                                </MudTooltip>
                            </MudPaper>
                        </MudItem>
                        <MudItem xs="1">
                            <MudButton @onclick="resetBossWeaponDurability" Variant="Variant.Filled" Color="Color.Dark" Size="Size.Small">Reset</MudButton>
                        </MudItem>

                    </MudGrid>
                </MudExpansionPanel>
            }
        </MudExpansionPanels>
    </MudContainer>
</MudMainContent>

@code {
    private void resetBossTierGeneration() => Data.enableBossTierGeneration = true;

    private List<int> bossWeaponDurability
    {
        get { return Data.bossWeaponDurability ?? [80, 100, 0, 20]; }
        set { Data.bossWeaponDurability = value; }
    }

    private void resetBossWeaponDurability() => Data.bossWeaponDurability = [80, 100, 0, 20];

    [CascadingParameter] public APBSConfig.Shared.MainLayout? Layout { get; set; }
}